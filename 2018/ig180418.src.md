## [Java] 大きな Excel ブックを Apache POI で作成

大きな Excel ブックを Apache POI を用いて作成するシンプルなサンプルをメモします。

完全なソースコードは以下にあります。

* <@link value="https://github.com/igapyon/simple-POIWriteExcel" />

ポイントとなるソースコードは以下。

```java
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.xssf.streaming.SXSSFWorkbook;

        try (SXSSFWorkbook workbook = new SXSSFWorkbook(10)) {
            for (int indexSheet = 0; indexSheet < 4; indexSheet++) {
                final Sheet sheet = workbook.createSheet();

                for (int indexColumn = 0; indexColumn < 20; indexColumn++) {
                    sheet.setColumnWidth(indexColumn, 256 * 3);
                }

                for (int indexRow = 0; indexRow < 100; indexRow++) {
                    final Row row = sheet.createRow(indexRow);
                    for (int indexColumn = 0; indexColumn < 10; indexColumn++) {
                        final Cell cell = row.createCell(indexColumn);
                        cell.setCellValue("Data of (" + indexColumn + ":" + indexRow + ")");
                    }
                }
            }

            try (BufferedOutputStream out = new BufferedOutputStream(new FileOutputStream("./target/aout.xlsx"))) {
                workbook.write(out);
            }

            workbook.dispose();
        }
```

<@lastmodified date="2018-04-18"/>
