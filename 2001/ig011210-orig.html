<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML lang="ja">
<HEAD>
<TITLE>2001/12/10 日記: 世間のDBコネクションプール実装を試す</TITLE>
<META name="DESCRIPTION" content="フリーなDBコネクションプール実装のお勧めを探索→PoolManに落ち着きそうです">
<META name="KEYWORDS" content="いがぴょんの日記v2,diary,igapyon,コネクションプール,JDBC,PoolMan,サンプルソースコード,Oracle">
<META name="GENERATOR" content="IBM WebSphere Homepage Builder Version 6.0.4.0 for Windows">
<META name="DATE" content="2010-09-27T20:42:45+09:00">
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<META http-equiv="Content-Style-Type" content="text/css">
<LINK rel="INDEX" href="index.html">
<LINK rel="CONTENTS" href="index.html">
</HEAD>
<BODY bgcolor="#eeddcc"><TABLE border="0"><TBODY><TR>
  <TD valign="top">
    <A href="../memo/memoigapyon.html">
      <IMG src="../images/iga200306s.jpg" border="0" ALT="いがぴょん画像(小) 2003/06">
    </A>
  </TD>
  <TD valign="top">
    <H2>2001/12/10 日記: 世間のDBコネクションプール実装を試す</H2>
    <P>[いがぴょんの日記v2,diary,igapyon,コネクションプール,JDBC,PoolMan,サンプルソースコード,Oracle] フリーなDBコネクションプール実装のお勧めを探索→PoolManに落ち着きそうです</P>
  </TD>
</TR></TBODY></TABLE>

<!-- adv -->
<CENTER>
<TABLE bgcolor="#ffff00" summary="adv">
  <TBODY>
    <TR>

      <TD align="center">広告: <A href="http://journal.mycom.co.jp/column/ide/091/">イマドキのIDE事情: Eclipseベースの統合翻訳環境「Benten」を使ってみよう</A> <FONT color="#ff0000" size="-1">09/27</FONT><BR>
        <FONT size="-1">たげぞうさんの手による Benten 紹介記事!</FONT></TD>

    </TR>
  </TBODY>
</TABLE>
</CENTER>
<!-- adv -->




<P> </P>

<DIV align="right">
<TABLE cellpadding="4">
  <TBODY>
    <TR bgcolor="#99ccff">
      <TD><A href="../idxall.html">インディックスページへ戻る</A></TD>
    </TR>
  </TBODY>
</TABLE>
</DIV>



<TABLE summary="mini title">
  <TBODY>
    <TR>
      <TD bgcolor="#ff9900" valign="top"><FONT color="#ffffff" size="+1"><STRONG>Palm Desktop 4.0.1 にバージョンアップ</STRONG></FONT></TD>
    </TR>
  </TBODY>
</TABLE>
<P>Windows XP 上で 旧バージョンの Palm HotSyncが超CPU消費をしてしまう不具合に耐えかねて、ついに
Palm Desktop 4.0.1 へとバージョンアップしてしまいました。(乱暴な…) でも
なんとなくちゃんと動作しています。これで CPU振り切りバグに関しては 煩わされずに済みそうです。なんたって
Palm Desktop と HotSync は 私にとってとっても重要なソフトウェアなんですもの。</P>
<TABLE summary="mini title">
  <TBODY>
    <TR>
      <TD bgcolor="#ff9900" valign="top"><FONT color="#ffffff" size="+1"><STRONG>DBコネクションプール実装 を軽く調べる</STRONG></FONT></TD>
    </TR>
  </TBODY>
</TABLE>
<P>コネクションプールで何か実装が必要なので、<BR>
手始めに かる～く Avalon Excalibur: Pool実装 を眺めました。でも ちょっとDBコネクションプールとしては使い物になりそうにありませんでした。</P>
<UL>
  <LI>Jakarta Avalon Excalibur: Pool実装<BR>
  <A HREF="http://jakarta.apache.org/avalon/excalibur/pool.html">http://jakarta.apache.org/avalon/excalibur/pool.html</A>
</UL>
<P>次に Jakarta Commons の DBCPを見てみました。が 現状 CVSのみでの提供なので、これはスキップ。</P>
<UL>
  <LI>Jakarta Commons: DBCP<BR>
  <A HREF="http://jakarta.apache.org/commons/index.html">http://jakarta.apache.org/commons/index.html</A>
</UL>
<P>…、素人目には Jakarta系は まだまだ使うことが出来る状態とは 思えません。さて、羽生さんが
何かの記事で 『コネクションプールは このライブラリがお勧め』 と書かれていたように記憶しますが、それは
一体どこだったでしょうか？ # 暗に聞いているのであった… (笑)</P>
<P><FONT color="#ff0000">2001/12/11</FONT> スガさんからツッコミ<BR>
<CITE>スガです。<BR>
羽生さんでなくて済みませんが(笑)<BR>
<A href="http://www.gihyo.co.jp/wdpress/vol5index.html">WEB+DB PRESS Vol.5</A> の記事で羽生さんが PoolMan を紹介されていますね。</CITE></P>
<UL>
  <LI><CITE>PoolMan Object Pooling Library and JDBC Driver<BR>
  <A HREF="http://www.codestudio.com/">http://www.codestudio.com/</A></CITE>
  <LI><CITE>PoolMan on SourceForge : LGPL</CITE><BR>
  <CITE><A HREF="http://sourceforge.net/projects/poolman/">http://sourceforge.net/projects/poolman/</A></CITE>
</UL>
<P><CITE>色々な人が挙げられているのでこれではないかと。私は使ったことがありませんけれど。<BR>
<BR>
# まだ八割方未読です &gt; Vol.5<BR>
# というか現在山のような積読が(苦笑)</CITE></P>
<P><FONT color="#ff0000">2001/12/11</FONT> <A HREF="http://d.hatena.ne.jp/habuakihiro/" TITLE="情報技術の開発現場で働く凄腕技術者で、且つ情報技術ライターをされている方。直接的な面識もあり とても強い影響を与えて貰っています。Flash MXを業務システムで使うという世界に私をいざなったのも羽生さん その人です。">羽生章洋</A>さんからツッコミ<BR>
<CITE>羽生＠熱があって沈没中（皆さんくれぐれもお気をつけて）です(^^;<BR>
＃　そんな私を万博公園に連れ出した我が家の姫ってば(T_T)<BR>
<BR>
&gt; 羽生さんでなくて済みませんが(笑)<BR>
フォローありがとうございますぅ～(^^)<BR>
<BR>
&gt; WEB+DB PRESS Vol.5 の記事で羽生さんが PoolMan を紹介されていますね。<BR>
&gt; 色々な人が挙げられているのでこれではないかと。<BR>
<BR>
とりあえず、私もあちこちでお薦めされた＆色々と試してみたので、まずはこれで大丈夫だと思います。<BR>
<BR>
＃　OracleのJDBCドライバにも標準でついてますよね、って話ではないんでしょうね(^^;<BR>
<BR>
さて、Avalon系といえば、最近のマイブ～ムはC2（Cocoon2）です。<BR>
いや～、面白い！つぅか楽！便利！最高！　私のように技術3流手抜き1流の人間のためにあるような仕組みです(^^;<BR>
<BR>
&gt; # まだ八割方未読です &gt; Vol.5<BR>
&gt; # というか現在山のような積読が(苦笑)<BR>
<BR>
最近積読を随分と解消しました(^^)v　東京・大阪を毎週往復するので移動時間の間に随分と消化しましたです、はい。<BR>
というわけで、沈没します。。。でわでわ。。。</CITE></P>
<P><FONT color="#ff00ff">ここから</FONT><A HREF="https://www.igapyon.jp/igapyon/diary/memo/memoigapyon.html" TITLE="いがぴょんに関する説明">いがぴょん</A><BR>
みなさま 早速のツッコミありがとうございます。さっそく PoolMan 2.0.4 を試してみます。見てみたら
現時点で 13,654ダウンロードもありました。すごい数だなぁ。<BR>
# ちなみに、Oracle JDBC にコネクションプールが実装されているってのは 全く把握できてませんでした。<BR>
、、、<BR>
Cocoon2は 羽生さんのことだから きっとハマっているに違いないと思っておりました。やはりハマってましたね
(笑)<BR>
<BR>
# ちなみに我が家のマイブームは 『あやめ池遊園地』</P>
<TABLE summary="mini title">
  <TBODY>
    <TR>
      <TD bgcolor="#ff9900" valign="top"><FONT color="#ffffff" size="+1"><STRONG>PoolManを使ってみる</STRONG></FONT></TD>
    </TR>
  </TBODY>
</TABLE>
<P><FONT color="#ff0000">12/11 11:20頃</FONT> PoolMan少し試し中…<BR>
Web+DB Press Vol.3は 買ったはずなのですが、見つけることが出来ず (苦笑)</P>
<UL>
  <LI>JNDI無しで動作するのかどうか試し中。
  <LI>最低限必要なJARは、jta.jar, poolman.jar である模様。
</UL>
<P>必要な変更は下記</P>
<UL>
  <LI>元 DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver());<BR>
  後 DriverManager.registerDriver(new com.codestudio.sql.PoolMan());
  <LI>元 Connection conn=DriverManager.getConnection(DNS,USER,PASS);<BR>
  後 Connection conn=DriverManager.getConnection(&quot;jdbc:poolman&quot;);
</UL>
<P>とりあえずの poolman.xml 設定は下記。</P>
<TABLE border="1">
  <TBODY>
    <TR>
      <TD><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;poolman&gt;
  &lt;management-mode&gt;local&lt;/management-mode&gt;

  &lt;datasource&gt;
    &lt;dbname&gt;iga&lt;/dbname&gt;
    &lt;jndiName&gt;jndi-iga&lt;/jndiName&gt;
    &lt;driver&gt;oracle.jdbc.driver.OracleDriver&lt;/driver&gt;
    &lt;url&gt;jdbc:oracle:thin:@localhost:1521:orcl&lt;/url&gt;
    &lt;username&gt;iga&lt;/username&gt;
    &lt;password&gt;iga&lt;/password&gt;

    &lt;nativeResults&gt;true&lt;/nativeResults&gt;
    &lt;maximumSoft&gt;false&lt;/maximumSoft&gt;

    &lt;logFile&gt;poolman.log&lt;/logFile&gt;
    &lt;debugging&gt;true&lt;/debugging&gt;
  &lt;/datasource&gt;

&lt;/poolman&gt;</pre></TD>
    </TR>
  </TBODY>
</TABLE>
<P>デフォルト設定に加えて、試しに nativeResults および maximumSoft を追加してみました。<BR>
ただし、現状 ずぼずぼINSERTを行うと OutOfMemoryError が発生して困っています。タスクマネージャを見ていると
じわじわメモリ使用量が増えていって、ついに破綻して OutOfMemoryErrorが発生してしまいます。コネクションプールを使わずに生で利用していたら
こんなこと無いのですが…。さて 原因は気長に調査するしか無いかしら…。ちとつまずいています。</P>
<P><FONT color="#ff0000">2001/12/11 12:53</FONT> <A HREF="http://d.hatena.ne.jp/habuakihiro/" TITLE="情報技術の開発現場で働く凄腕技術者で、且つ情報技術ライターをされている方。直接的な面識もあり とても強い影響を与えて貰っています。Flash MXを業務システムで使うという世界に私をいざなったのも羽生さん その人です。">羽生章洋</A>さんからツッコミ<BR>
<CITE>羽生＠全然風邪が治らない、です。<BR>
<BR>
&gt; Web+DB Press Vol.3は 買ったはずなのですが、見つけることが出来ず <BR>
<BR>
えとえと、<A href="http://www.gihyo.co.jp/wdpress/vol5index.html">Vol.5</A>です(^^;　尚、Vol.3には、FlashをWebクライアントにするという記事を書いています（で、これはもうすぐ結構面白いものを公開できる予定です）。<BR>
＃　宣伝宣伝(^^;</CITE></P>
<P><FONT color="#ff00ff">ここから</FONT><A HREF="https://www.igapyon.jp/igapyon/diary/memo/memoigapyon.html" TITLE="いがぴょんに関する説明">いがぴょん</A><BR>
ああっ、3と5を見間違え (苦笑)。<A href="http://www.gihyo.co.jp/wdpress/vol5index.html">Vol.5</A>は 会社の先輩 ヒトミさんが購入しただけでしたから、私も これを機に買ってみようと思いますです。JDBC周りの良い記事がたくさん載っていますね。これは買いだなぁ。</P>

<!-- Generated by JMdRdf (Java Midori Rdf) 1.7.1 Templete Processer Engine -->
<!--     source='ig011210.src.html' , result='ig011210.html' -->
<TABLE summary="mini title"><TBODY><TR><TD bgcolor="#44cc77" valign="top"><FONT color="#ffffff" size="+1"><STRONG>世間のニュースから <FONT SIZE="-1">(<A HREF="ig011210-news.xml">RSS</A>)</FONT> <FONT COLOR="#ff0000" SIZE="-1">2001</FONT></STRONG></FONT></TD></TR></TBODY></TABLE><UL><LI><A HREF="http://www.zdnet.co.jp/macwire/0112/03/n_md_news3.html">Mac OS XのJava 1.4対応は2002年5月にプレビューで8月に正式版</A> <FONT size="-2"><A target="_blank" HREF="http://www.zdnet.co.jp/macwire/0112/03/n_md_news3.html">(O)</A></FONT> <FONT COLOR="#ff0000" SIZE="-1">2001</FONT><BR>2002/02 J2SE 1.3.1アップデート1 。2002/05 J2SE 1.3.1アップデート2。2002/02 J2SE 1.4。<LI><A HREF="http://www.yomiuri.co.jp/04/20011203i415.htm">社内電子メールのプライバシーは限定的…東京地裁判決</A> <FONT size="-2"><A target="_blank" HREF="http://www.yomiuri.co.jp/04/20011203i415.htm">(O)</A></FONT> <FONT COLOR="#ff0000" SIZE="-1">2001</FONT><BR>誤った宛先には十分注意しましょう。<LI><A HREF="http://www.zdnet.co.jp/news/0112/08/b_1207_03.html">Windows NT Server 4.0，2003年7月に全面引退</A> <FONT size="-2"><A target="_blank" HREF="http://www.zdnet.co.jp/news/0112/08/b_1207_03.html">(O)</A></FONT> <FONT COLOR="#ff0000" SIZE="-1">2001</FONT><BR>Windows NT 4.0 は そこそこ気に入っていました。</UL> <HR>
<address><A HREF="../memo/memoigapyon.html">いがぴょんについて</A><BR>
Last modified: $Date: 2010/09/27 20:42:45 $</address>
</BODY>
</HTML>
