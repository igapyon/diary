## [Sonatype][Maven] Java プロジェクトを新規に Maven Repos に投入

プロジェクトを新しく Maven Repos に登録しようとしています。

あらためて [Sonatypeの説明](http://central.sonatype.org/pages/apache-maven.html) を見ながら設定を見直し中。

まず、そもそも登録しようと <@link value="https://issues.sonatype.org/browse/OSSRH-28009" /> チケットを作成したが、これは　Joel さんからの回答によると、私はすでに jp.igapyon で登録済みだから、Sonatype への登録作業に向けてはこの申請は不要であり既に実施可能状態とのことです。
なお、Sonatype登録しようとして、Javadoc の記述が不足気味であることが判明しました。せっせと Javadoc を記述しました。

Maven 基本プラグインでリリースする場合は、以下のコマンドで。

```sh
mvn release:prepare
mvn release:perform
```

Sonatype のステージングについては以下。

<@link value="https://oss.sonatype.org/content/groups/public/jp/igapyon/" />

使った手順。
* 内容が良ければ -SNAPSHOT 抜きで正式リリースします。
* 普段は1.5.3-SNAPSHOTのようなバージョン番号だが、リリースの場合のみ、 1.5.3のように「-SNAPSHOT」を除去してコミット＋PUSH します。
* mvn release:prepare します。
* pom.xml をローカル上のみ1.5.3-SNAPSHOTと手動変更します。（コミットしない）
* mvn release:perform します。
* 最後に git にコミット＋PUSHします。

ステージングから昇格???

https://oss.sonatype.org/#stagingRepositories
Staging Repositories
=> Select and 'Close'
and release???


## リポジトリ連携の動作確認

Sonatype 上のリポジトリでうまく動くことを、以下のように pom.xml を書き変えて確認します。

### pom.xml for Sonatype

```xml
    <repositories>
        <repository>
            <id>oss-sonatype</id>
            <name>oss-sonatype</name>
            <url>https://oss.sonatype.org/content/repositories/snapshots/</url>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </repository>
    </repositories>

    <dependencies>
        <dependency>
            <groupId>jp.igapyon.blanco.apex.parser</groupId>
            <artifactId>blancoApexParser</artifactId>
            <version>1.5.1-SNAPSHOT</version>
        </dependency>
    </dependencies>
```


## いつも忘れる settings.xml

これを忘れると Sonatype リリースにて認証エラーが発生します。

#### .m2/settings.xml

```xml
<settings>
  <servers>
    <server>
      <id>ossrh</id>
      <username>username-of-sonatypejira</username>
      <password>password-of-sonatypejira</password>
    </server>
  </servers>
</settings>
```

<@lastmodified date="2017-10-07"/>
