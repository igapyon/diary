[top](https://igapyon.github.io/diary/) 
 / [index](https://igapyon.github.io/diary/2017/index.html) 
 / [prev](https://igapyon.github.io/diary/2017/ig170112.html) 
 / [next](https://igapyon.github.io/diary/2017/ig170114.html) 
 / [target](https://igapyon.github.io/diary/2017/ig170113.html) 
 / [source](https://github.com/igapyon/diary/blob/gh-pages/2017/ig170113.html.src.md) 

2017-01-13 diary: [igapyonv3] 現時点の仕様メモ
=====================================================================================================
[![いがぴょん画像(小)](https://igapyon.github.io/diary/images/iga200306s.jpg "いがぴょん")](https://igapyon.github.io/diary/memo/memoigapyon.html) 日記形式でつづる [いがぴょん](https://igapyon.github.io/diary/memo/memoigapyon.html)コラム ウェブページです。

## [igapyonv3] 現時点の仕様メモ

現時点の [igapyonv3](https://igapyon.github.io/diary/keyword/igapyonv3.html) の仕様をメモします。

## 使い方

XXXを参照して実行。
実行には [Maven](https://igapyon.github.io/diary/keyword/maven.html) 環境が必要。
FreeMarker ベース

## [igapyonv3] のカスタム ディレクティブ一覧

[igapyonv3](https://igapyon.github.io/diary/keyword/igapyonv3.html) のカスタム ディレクティブ一覧を以下にメモしておきます。

### リンク出力

#### 検索系

* `<@linksearch title="いがぴょん検索" word="いがぴょん" />`
  * [いがぴょん検索](https://www.google.co.jp/#pws=0&q=%E3%81%84%E3%81%8C%E3%81%B4%E3%82%87%E3%82%93)
* `<@linksearch title="いがぴょん検索サイト内" word="いがぴょん" site="https：//igapyon.github.io/diary/" />`
  * [いがぴょん検索サイト内](https://www.google.co.jp/#pws=0&q=site:https%3A%2F%2Figapyon.github.io%2Fdiary%2F+%E3%81%84%E3%81%8C%E3%81%B4%E3%82%87%E3%82%93)
* `<@linksearch title="いがぴょんTwitter" word="伊賀敏樹" engine="twitter" />`
  * [いがぴょんTwitter](https://twitter.com/search?q=%23%E4%BC%8A%E8%B3%80%E6%95%8F%E6%A8%B9)

#### SNS系

* `<@linkshare word="テスト" url="https：//igapyon.github.io/diary/" tags="いがぴょん" />`
  * [Twitterでシェア](https://twitter.com/intent/tweet?hashtags=%E3%81%84%E3%81%8C%E3%81%B4%E3%82%87%E3%82%93&text=%E3%83%86%E3%82%B9%E3%83%88&url=https%3A%2F%2Figapyon.github.io%2Fdiary%2F)

#### その他

* `<@linkdiary date="2017-01-14" />`
  * [2017-01-14 diary: [igapyonv3] のカスタム ディレクティブ一覧](https://igapyon.github.io/diary/2017/ig170114.html)
* `<@linkamazon title="JDBC本" dp="4839913935" />`
  * [JDBC本](https://www.amazon.co.jp/exec/obidos/ASIN/4839913935/igapyondiary-22)
* `<@linkmap word="mapテスト" lat="35.6722478" lon="139.7214164" />`
  * [地図で表示](https://openstreetmap.jp/map#zoom=17&lat=35.6722478&lon=139.7214164&layers=00BFF)

### リスト展開

#### RSS系

`<@rssfeed url="http：//www.publickey1.jp/atom.xml" maxcount="0" />`

#### [Publickey](http://www.publickey1.jp/)



`<@localrss />`

* [2017-01-14 diary: [igapyonv3] のカスタム ディレクティブ一覧](ig170114.html)
* [2017-01-13 diary: [igapyonv3] 現時点の仕様メモ](ig170113.html)
* [2017-01-12 diary: [Shell] シェルから内容込みでファイルを作成する方法メモ](ig170112.html)
* [2017-01-11 diary: [igapyonv3] PegDown が EOL とのことらしい](ig170111.html)
* [2017-01-10 diary: [igapyonv3] Twitter シェアの機能を確認中](ig170110.html)
* [2017-01-09 diary: 2017年正月休み成果 [igapyonv3], [gh-pages], [Maven], [FreeMarker]](ig170109.html)
* [2017-01-08 diary: 日記ジェネレータ [igapyonv3] のキーワードシステム構築中](ig170108.html)
* [2017-01-07 diary: [FreeMarker] のカスタムディレクティブ秀逸](ig170107.html)
* [2017-01-06 diary: [FreeMarker] Java 処理を伴うカスタムタグのシンプルメモ](ig170106.html)
* [2017-01-05 diary: [FreeMarker] の処理解釈を抑止する方法](ig170105.html)
* [2017-01-04 diary: [github] gh-pages のビルドエラーを体験 → [jekyll] 問題](ig170104.html)
* [2017-01-03 diary: 「いがぴょんの日記v3」システム [igapyonv3] に機能追加中](ig170103.html)
* [2017-01-02 diary: [Maven] によるシンプル Java プロジェクトサンプルの作成手順](ig170102.html)
* [2017-01-01 diary: [FreeMarker] シンプルサンプル](ig170101.html)


### 取り込み展開

#### ファイル取り込み展開

`<@include file="ig170101.html.src.md" />`

## [FreeMarker] シンプルサンプル

[Java](https://igapyon.github.io/diary/keyword/java.html) 言語によるプログラミングのなかでテキストのテンプレート処理が必要な場面で役立つ OSS 実装の一つに [Apache](https://igapyon.github.io/diary/keyword/apache.html) [FreeMarker](https://igapyon.github.io/diary/keyword/freemarker.html) というプロダクトがあります。こちらが私が実現したかったテキストのテンプレート処理で役立ちそうだったので、これのシンプルな実装サンプルを作成します。

### 基本的な maven 作成および必要なライブラリの組み込み

#### シンプルな Java プロジェクトの新規作成

以下の手順に従い、[Maven](https://igapyon.github.io/diary/keyword/maven.html) によるシンプルな Java プロジェクトを新規作成してください。

* [2017-01-02 diary: [Maven] によるシンプル Java プロジェクトサンプルの作成手順](https://igapyon.github.io/diary/2017/ig170102.html)

#### Maven プロジェクト設定を変更してライブラリ組み込み

以下のように `pom.xml` を変更します。（変更箇所のみ記載）

```xml
  <dependencies>
    <!-- 既存の記述... -->
    <dependency>
      <groupId>org.freemarker</groupId>
      <artifactId>freemarker</artifactId>
      <version>[2.3.25-incubating,3.0)</version>
    </dependency>
  </dependencies>
```

### Java ソースコードの記述

以下のように Java ソースコードを開きます。

```sh
vi src/main/java/my/sandbox/App.java 
```

以下のように `App.java` を記述します。

```java
package my.sandbox;

import java.io.IOException;
import java.io.OutputStreamWriter;
import java.io.Reader;
import java.io.StringReader;
import java.util.HashMap;
import java.util.Map;

import freemarker.cache.TemplateLoader;
import freemarker.template.Configuration;
import freemarker.template.Template;
import freemarker.template.TemplateException;
import freemarker.template.TemplateExceptionHandler;

public class App {
  public static void main(String[] args) throws IOException, TemplateException {
    final Configuration config = new Configuration(Configuration.VERSION_2_3_25);
    config.setDefaultEncoding("UTF-8");
    config.setTemplateExceptionHandler(TemplateExceptionHandler.RETHROW_HANDLER);
    config.setLogTemplateExceptions(false);

    // set my custom template loader.
    config.setTemplateLoader(new TemplateLoader() {
      private long lastModified = System.currentTimeMillis();

      private static final String MY_TEMPLATE_STRING = "My name is ${user} desu.";

      public Object findTemplateSource(String name) throws IOException {
        System.out.println("TemplateName:" + name);
        return MY_TEMPLATE_STRING;
      }

      public long getLastModified(Object templateSource) {
        return lastModified;
      }

      public Reader getReader(Object templateSource, String encoding) throws IOException {
        return new StringReader(MY_TEMPLATE_STRING);
      }

      public void closeTemplateSource(Object templateSource) throws IOException {
        // do nothing.
      }
    });

    final Map<String, String> templateData = new HashMap<String, String>();
    templateData.put("user", "Taro Yamada");

    final Template templateBase = config.getTemplate("basic");
    templateBase.process(templateData, new OutputStreamWriter(System.out));
  }
}
```

### Java アプリの実行

以下のコマンドで、作成した Java アプリケーションを実行することができます。

```sh
mvn install exec:java
```

### 感想

[Apache](https://igapyon.github.io/diary/keyword/apache.html) FreeMarker は基本的なテンプレート操作機能が備わっているように、今のところは感じています。

### 関連する日記

* [2017-01-06 diary: [FreeMarker] Java 処理を伴うカスタムタグのシンプルメモ](https://igapyon.github.io/diary/2017/ig170106.html)
* [2017-01-02 diary: [Maven] によるシンプル Java プロジェクトサンプルの作成手順](https://igapyon.github.io/diary/2017/ig170102.html)

## 2017年 あけまして おめでとう ございます

さあ、今年も、健康に１年が過ごせますように。



## 登場キーワード

* [igapyonv3](https://igapyon.github.io/diary/keyword/igapyonv3.html)
* [Maven](https://igapyon.github.io/diary/keyword/maven.html)

----------------------------------------------------------------------------------------------------

## この日記について
[いがぴょんについて](https://igapyon.github.io/diary/memo/memoigapyon.html) / [日記ジェネレータ](https://github.com/igapyon/igapyonv3)
